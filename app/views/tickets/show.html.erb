<div class="ticket">
  <header>
    <h1><%= @project.name %></h1>
  </header>

  <header>
    <h2><%= @ticket.name %></h2>

    <ul>
      <li><%= link_to  "Edit Ticket", [:edit, @project, @ticket] %></li>
      <li><%= link_to  "Delete Ticket", [@project, @ticket], method: :delete,
        data: { confirm: "Are you sure you want to delete this ticket?"} %></li>
    </ul>
  </header>

  <table class="attributes">
    <tr>
      <th>Author:</th>
      <td><%= @ticket.author.email %></td>
    </tr>
    <tr>
      <th>Created:</th>
      <td><%= time_ago_in_words(@ticket.created_at) %></td>
    </tr>
    <% if @ticket.state.present? %>
      <tr>
        <th>State:</th>
        <td><%= render @ticket.state %></td>
      </tr>
    <% end %>
  </table>

  <%= simple_format(@ticket.description) %>

  <div class="comments">
    <header>
      <h3>Comments</h3>
    </header>

    <% comments = @ticket.comments.persisted.ordered %>
    <% if comments.any? %>
      <%= render comments %>
    <% else %>
      <p>There are no comments for this ticket.</p>
    <% end %>

    <%= render "comments/form", ticket: @ticket, comment: @comment %>
  </div>

</div>